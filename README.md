# ZooKeeper
A hack for [HackUMass VI](https://hackumass.com/) by the UMass PenTesting Team + 2.

## Table of Contents
<!-- TOC -->

- [ZooKeeper](#zookeeper)
  - [Table of Contents](#table-of-contents)
  - [Overview](#overview)
  - [Hack](#hack)
  - [Team](#team)
  - [Setup](#setup)
    - [Requirements](#requirements)
    - [Steps](#steps)
  - [Usage](#usage)
    - [On the Raspberry Pi](#on-the-raspberry-pi)
    - [In Real Life](#in-real-life)
    - [Device](#device)

<!-- /TOC -->

## Overview
The purpose of our hack is to conduct man-in-the-middle (MitM) and denial-of-service (DOS)exploits on RFID cards of various bit capacities. Our primary motivation was to hack the UMass RFID system.
Our exploits were tested using the iClass r-640x-300 reader (tag).

We had two subteams: one worked on researching protocols and exploits for the UCards and the other set up the tool that employs MitM and DOS attacks.

## Hack
Our hack consists of a second-hand RFID scanner hooked up to a Raspberry Pi and an Arduino. The RFID scanner reads in card data which the Arduino processes and logs. The data is then sent along to a web server that the Raspberry Pi hosts. The web server hides the logged data behind a login screen. After entering in the correct login, the attacker can access the card data of whoever has unknowingly used their dummy scanner. To use the data, the attacker can select a card code from a dropdown and click "Open Sesame" or "Lock" to lock the door that they've planted the dummy scanner on.

## Team
- Nils Carlson
- Michael Roffo
- Jordan Chen
- Nicholas Sichalov
- Jake Quilty
- Aaron Terentiev
## Setup
### Requirements
- Python 3.6+
- virtualenv
### Steps
1. Clone this repository
2. Navigate into the project folder
```bash
cd UMPenTest_RFID_hack
```
3. Activate the virtual environment
```bash
source venv/bin/activate
```
4. Install the project packages
```bash
pip install -r requirements.txt
```

## Usage
### On the Raspberry Pi
To run the local web server:
1. Export the requisite environment variables
```bash
export FLASK_APP=UMPenTest_RFID_hack.py
export FLASK_ENV=development
```
2. Run the Flask web server
```bash
sudo python3.6 UMPenTest_RFID_hack.py
```
3. Navigate to the server IP (default: http://127.0.0.1:5000/)

4. Enter your credentials
![Alt text](/screenshots/login_page.png "The login page")

5. Select a logged card code from the dropdown and press either "Open Sesame" or "Lock"
![Alt text](/screenshots/code_page.png "The code page")

### In Real Life
After getting the Pi up and running:
1. Rip out the RFID scanner on a door/building
2. Install our tool
3. Navigate to the web address and port that you have the Pi running on
4. Enter your login credentials
5. Enjoy life in prison

### Device
![Alt text](/screenshots/setup.jpg "The setup")
![Alt text](/screenshots/device.jpg "The device -- it's real neat!")

